webshim.register("usermedia-shim",function(a,b,c,d,e,f){"use strict";function g(a,c,d){o?b.mediaelement.createSWF?h(a,c,d):(b.loader.loadList(["swfmini-embed"]),b.mediaelement.loadSwf=!0,b.reTest(["mediaelement-jaris"],!0),b.ready("mediaelement-jaris",function(){h(a,c,d)})):d({name:"NOT_SUPPORTED_ERROR"})}function h(a,b,c){var d,e=i();e&&(l++,d="webshimstream:stream"+l,n[d]={src:d,success:b,fail:c},k(),p.createSWF(e,{srcProp:d,streamrequest:!0,type:"jarisplayer/stream"}))}function i(){var c=a("video");return c=c.filter(".ws-usermedia"),c.length||(c=c.end()),1!=c.length&&(c=c.filter(q)),1!=c.length&&b.error('for getUserMedia an empty video element has to be already in the DOM. If you provide multiple empty videos. please mark your suggested video using the "ws-usermedia" class.'),c[0]}function j(a,c,d){b.defineProperties(this,{_swf:{value:c,enumerable:!1},_data:{value:a,enumerable:!1},_wsStreamId:{value:d,enumerable:!1}})}var k,l=0,m={},n={},o=swfmini.hasFlashPlayerVersion("11.3"),p=b.mediaelement,q=function(){return!a.prop(this,"currentSrc")&&!p.srces(this).length};j.prototype={currentTime:0,stop:function(){p.queueSwfMethod(this._data._elem,"api_detach",[],this._data)}},b.usermedia={attach:function(c,d,e){e._usermedia==d.srcProp?(p.queueSwfMethod(e._elem,"api_attach",[],e),a(e._elem).trigger("loadstart")):b.error("something went wrong")},request:function(b,c,d){d._usermedia=c.srcProp,a(d.api).css(f.inline||a(b).hasClass("ws-inlineusermedia")?{position:"relative",zIndex:"999999"}:{position:"fixed",top:0,left:0,width:"100%",height:150,zIndex:"999999"})}};var r=URL.createObjectURL,s=URL.revokeObjectURL;URL.createObjectURL=function(a){var b=a;return r&&!a._wsStreamId?b=r.apply(this,arguments):a._wsStreamId&&(b=a._wsStreamId,m[b]=a),b},URL.revokeObjectURL=function(a){if(m[a])delete m[a];else if(s)return s.apply(this,arguments)},b.usermediastreams=m,k=function(){if(b.mediaelement.createSWF){k=a.noop;var c=function(b){setTimeout(function(){a(b.api).css({position:"",top:"",left:"",width:"",height:"",zIndex:""}),a.prop(b._elem,"controls")&&a.prop(b._elem,"controls",!0)},50)},d=function(a,b){c(b),n[b._usermedia].fail({name:a.type})};a.extend(p.onEvent,{NotSupportedError:d,PermissionDeniedError:d,ConstraintNotSatisfiedError:d,onUserSuccess:function(a,b){c(b),n[b._usermedia].success(new j(b,b.api,b._usermedia))}})}},b.ready("mediaelement-jaris",k),b.getUserMedia=g,navigator.wsGetUserMedia=g,b.isReady("usermedia-api",!0)});